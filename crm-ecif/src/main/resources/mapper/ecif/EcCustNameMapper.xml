<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.com.zsyk.crm.ecif.mapper.EcCustNameMapper">
  <resultMap id="BaseResultMap" type="cn.com.zsyk.crm.ecif.entity.EcCustName">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="cust_no" jdbcType="VARCHAR" property="custNo" />
    <result column="cust_nam" jdbcType="VARCHAR" property="custNam" />
    <result column="frmer_nam1" jdbcType="VARCHAR" property="frmerNam1" />
    <result column="frmer_nam2" jdbcType="VARCHAR" property="frmerNam2" />
    <result column="eff_date" jdbcType="VARCHAR" property="effDate" />
    <result column="exp_date" jdbcType="VARCHAR" property="expDate" />
    <result column="data_source" jdbcType="VARCHAR" property="dataSource" />
    <result column="create_date" jdbcType="VARCHAR" property="createDate" />
    <result column="create_time" jdbcType="VARCHAR" property="createTime" />
    <result column="create_user" jdbcType="VARCHAR" property="createUser" />
    <result column="update_date" jdbcType="VARCHAR" property="updateDate" />
    <result column="update_time" jdbcType="VARCHAR" property="updateTime" />
    <result column="update_user" jdbcType="VARCHAR" property="updateUser" />
    <result column="time_stamp" jdbcType="TIMESTAMP" property="timeStamp" />
    <result column="rec_stat" jdbcType="VARCHAR" property="recStat" />
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from ec_cust_name
    where cust_no = #{custNo,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="cn.com.zsyk.crm.ecif.entity.EcCustName">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into ec_cust_name (cust_no, cust_nam, frmer_nam1, 
      frmer_nam2, eff_date, exp_date, 
      data_source, create_date, create_time, 
      create_user, update_date, update_time, 
      update_user, time_stamp, rec_stat
      )
    values (#{custNo,jdbcType=VARCHAR}, #{custNam,jdbcType=VARCHAR}, #{frmerNam1,jdbcType=VARCHAR}, 
      #{frmerNam2,jdbcType=VARCHAR}, #{effDate,jdbcType=VARCHAR}, #{expDate,jdbcType=VARCHAR}, 
      #{dataSource,jdbcType=VARCHAR}, #{createDate,jdbcType=VARCHAR}, #{createTime,jdbcType=VARCHAR}, 
      #{createUser,jdbcType=VARCHAR}, #{updateDate,jdbcType=VARCHAR}, #{updateTime,jdbcType=VARCHAR}, 
      #{updateUser,jdbcType=VARCHAR}, #{timeStamp,jdbcType=TIMESTAMP}, #{recStat,jdbcType=VARCHAR}
      )
  </insert>
  <update id="updateByPrimaryKey" parameterType="cn.com.zsyk.crm.ecif.entity.EcCustName">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update ec_cust_name
    set cust_nam = #{custNam,jdbcType=VARCHAR},
      frmer_nam1 = #{frmerNam1,jdbcType=VARCHAR},
      frmer_nam2 = #{frmerNam2,jdbcType=VARCHAR},
      eff_date = #{effDate,jdbcType=VARCHAR},
      exp_date = #{expDate,jdbcType=VARCHAR},
      data_source = #{dataSource,jdbcType=VARCHAR},
      create_date = #{createDate,jdbcType=VARCHAR},
      create_time = #{createTime,jdbcType=VARCHAR},
      create_user = #{createUser,jdbcType=VARCHAR},
      update_date = #{updateDate,jdbcType=VARCHAR},
      update_time = #{updateTime,jdbcType=VARCHAR},
      update_user = #{updateUser,jdbcType=VARCHAR},
      time_stamp = #{timeStamp,jdbcType=TIMESTAMP},
      rec_stat = #{recStat,jdbcType=VARCHAR}
    where cust_no = #{custNo,jdbcType=VARCHAR}
  </update>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select cust_no, cust_nam, frmer_nam1, frmer_nam2, eff_date, exp_date, data_source, 
    create_date, create_time, create_user, update_date, update_time, update_user, time_stamp, 
    rec_stat
    from ec_cust_name
    where cust_no = #{custNo,jdbcType=VARCHAR}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select cust_no, cust_nam, frmer_nam1, frmer_nam2, eff_date, exp_date, data_source, 
    create_date, create_time, create_user, update_date, update_time, update_user, time_stamp, 
    rec_stat
    from ec_cust_name
  </select>
  <delete id="deleteByCustNo"  parameterType="java.lang.String">
    delete from ec_cust_name
    where cust_no = #{custNo,jdbcType=VARCHAR}
  </delete>

  <select id="selectCustNo" parameterType="java.lang.String" resultType="java.lang.String">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select cust_no
    from ec_cust_name
    where cust_no = #{custNo,jdbcType=VARCHAR}
  </select>
  <select id="selectCustNos" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select t1.cust_no
    from ec_cust_per t1
          left join ec_cust_name t2  on t1.cust_no=t2.cust_no
          left join ec_cust_cert t3  on t1.cust_no=t3.cust_no
          left join ec_contact_way t4 on t1.cust_no=t4.cust_no
          left join ec_contact_addr t5 on t1.cust_no=t5.cust_no
    where 1=1
      and t1.cust_stat ='0'
      and t1.CUST_NO NOT IN(SELECT r.SIMILAR_CUST_NO CUST_NO FROM EC_SIM_CUST r WHERE r.rec_stat='0' and r.SIM_CUST_STATE in('0','1'))
    <if test="timeStamp!=null and timeStamp!=''">
      and TO_TIMESTAMP(t1.TIME_STAMP,'YYYY-MM-DD HH24:MI:SS:FF6') &gt; TO_TIMESTAMP(#{timeStamp,jdbcType=TIMESTAMP},'YYYY-MM-DD HH24:MI:SS:FF6')
    </if>
  </select>
  <!-- 获取所有客户的总数量 -->
  <select id="selectAllCustCount" parameterType="java.lang.String" resultType="java.lang.Long">
    select count(*)
    from ec_cust_per t1
    left join ec_cust_name t2  on t1.cust_no=t2.cust_no
    left join ec_cust_cert t3  on t1.cust_no=t3.cust_no
    where 1=1
    and t1.cust_stat ='0'
    and t1.CUST_NO NOT IN(SELECT r.SIMILAR_CUST_NO CUST_NO FROM EC_SIM_CUST r WHERE r.rec_stat='0' and r.SIM_CUST_STATE in('0','1','4'))
    <if test="stampTime!=null and stampTime!=''">
      and TO_TIMESTAMP(t1.TIME_STAMP,'YYYY-MM-DD HH24:MI:SS:FF6')  &gt; TO_TIMESTAMP(#{stampTime,jdbcType=TIMESTAMP},'YYYY-MM-DD HH24:MI:SS:FF6')
    </if>
  </select>
</mapper>