<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.com.zsyk.crm.query.mapper.GSClientpermainMapper" >
    <resultMap id="BaseResultMap" type="cn.com.zsyk.crm.query.entity.GSClientpermain">
        <id column="CLIENTCODE" jdbcType="VARCHAR" property="clientcode" />
        <result column="CLIENTCNAME" jdbcType="VARCHAR" property="clientcname" />
        <result column="CLIENTENAME" jdbcType="VARCHAR" property="clientename" />
        <result column="CLIENTTYPE" jdbcType="VARCHAR" property="clienttype" />
        <result column="JOINDATE" jdbcType="TIMESTAMP" property="joindate" />
        <result column="BLACKLISTIND" jdbcType="VARCHAR" property="blacklistind" />
        <result column="FORMALIND" jdbcType="VARCHAR" property="formalind" />
        <result column="VIPIND" jdbcType="VARCHAR" property="vipind" />
        <result column="CANCELIND" jdbcType="VARCHAR" property="cancelind" />
        <result column="CANCELREASON" jdbcType="VARCHAR" property="cancelreason" />
        <result column="CANCELDATE" jdbcType="TIMESTAMP" property="canceldate" />
        <result column="RELATEDCLIENT" jdbcType="VARCHAR" property="relatedclient" />
        <result column="REMARK" jdbcType="VARCHAR" property="remark" />
        <result column="FLAG" jdbcType="VARCHAR" property="flag" />
        <result column="CONNECTION" jdbcType="VARCHAR" property="connection" />
        <result column="POSTCODE" jdbcType="VARCHAR" property="postcode" />
        <result column="POSTADDRESS" jdbcType="VARCHAR" property="postaddress" />
        <result column="QUALITYIND" jdbcType="VARCHAR" property="qualityind" />
        <result column="CLIENTSTATUS" jdbcType="VARCHAR" property="clientstatus" />
        <result column="VISITIND" jdbcType="VARCHAR" property="visitind" />
        <result column="BANKCODE" jdbcType="VARCHAR" property="bankcode" />
        <result column="ACCOUNTNO" jdbcType="VARCHAR" property="accountno" />
        <result column="MONEYLAUNDERINGIND" jdbcType="VARCHAR" property="moneylaunderingind" />
        <result column="DIRECTCLIENTIND" jdbcType="VARCHAR" property="directclientind" />
        <result column="SCANDOCIND" jdbcType="VARCHAR" property="scandocind" />
        <result column="ORIGINCLIENTCODE" jdbcType="VARCHAR" property="originclientcode" />
        <result column="RELATECLIENTCODE" jdbcType="VARCHAR" property="relateclientcode" />
        <result column="CREATORCODE" jdbcType="VARCHAR" property="creatorcode" />
        <result column="CREATETIME" jdbcType="TIMESTAMP" property="createtime" />
        <result column="UPDATERCODE" jdbcType="VARCHAR" property="updatercode" />
        <result column="UPDATETIME" jdbcType="TIMESTAMP" property="updatetime" />
        <result column="ITEMPROVINCECODE" jdbcType="VARCHAR" property="itemprovincecode" />
        <result column="ITEMCITYCODE" jdbcType="VARCHAR" property="itemcitycode" />
        <result column="ITEMPROVINCECNAME" jdbcType="VARCHAR" property="itemprovincecname" />
        <result column="ITEMCITYCNAME" jdbcType="VARCHAR" property="itemcitycname" />
        <result column="STARLEVEL" jdbcType="VARCHAR" property="starlevel" />
        <result column="SPECIALCLIENT" jdbcType="VARCHAR" property="specialclient" />
        <result column="IDCARDVALIDITY" jdbcType="VARCHAR" property="idcardvalidity" />
        <result column="ADDRESSCNAME" jdbcType="VARCHAR" property="addresscname" />
        <result column="ADDRESSENAME" jdbcType="VARCHAR" property="addressename" />
        <result column="IDENTIFYTYPE" jdbcType="VARCHAR" property="identifytype" />
        <result column="IDENTIFYNUMBER" jdbcType="VARCHAR" property="identifynumber" />
        <result column="ORIINALIDENTIFYNUMBER" jdbcType="VARCHAR" property="oriinalidentifynumber" />
        <result column="BIRTHDATE" jdbcType="TIMESTAMP" property="birthdate" />
        <result column="COUNTRY_CODE" jdbcType="VARCHAR" property="countryCode" />
        <result column="NATIONALITY" jdbcType="VARCHAR" property="nationality" />
        <result column="REGISTADDRESS" jdbcType="VARCHAR" property="registaddress" />
        <result column="REGINONCODE" jdbcType="VARCHAR" property="reginoncode" />
        <result column="HOMEPLACE" jdbcType="VARCHAR" property="homeplace" />
        <result column="MARRIAGE" jdbcType="VARCHAR" property="marriage" />
        <result column="LIVINGCITY" jdbcType="VARCHAR" property="livingcity" />
        <result column="MARRIAGEDATE" jdbcType="TIMESTAMP" property="marriagedate" />
        <result column="SEX" jdbcType="VARCHAR" property="sex" />
        <result column="GRADUATESCHOOL" jdbcType="VARCHAR" property="graduateschool" />
        <result column="EDUCATIONCODE" jdbcType="VARCHAR" property="educationcode" />
        <result column="MAJORCODE" jdbcType="VARCHAR" property="majorcode" />
        <result column="OCCUPATIONCODE" jdbcType="VARCHAR" property="occupationcode" />
        <result column="OCCUPATION" jdbcType="VARCHAR" property="occupation" />
        <result column="PARTTIMEJOBCODE" jdbcType="VARCHAR" property="parttimejobcode" />
        <result column="PARTTIMEJOB" jdbcType="VARCHAR" property="parttimejob" />
        <result column="OCCUPATIONTYPE" jdbcType="VARCHAR" property="occupationtype" />
        <result column="WORDRISKRANK" jdbcType="VARCHAR" property="wordriskrank" />
        <result column="UTIT" jdbcType="VARCHAR" property="utit" />
        <result column="UTITADDRESS" jdbcType="VARCHAR" property="utitaddress" />
        <result column="JOBATEA" jdbcType="VARCHAR" property="jobatea" />
        <result column="JOBDEPARTMENT" jdbcType="VARCHAR" property="jobdepartment" />
        <result column="OWNERSHIPCODE" jdbcType="VARCHAR" property="ownershipcode" />
        <result column="JOINCOMPANYDATE" jdbcType="TIMESTAMP" property="joincompanydate" />
        <result column="STARTWORKDATE" jdbcType="TIMESTAMP" property="startworkdate" />
        <result column="POSITION" jdbcType="VARCHAR" property="position" />
        <result column="TITLECODE" jdbcType="VARCHAR" property="titlecode" />
        <result column="SALARY" jdbcType="DECIMAL" property="salary" />
        <result column="WORDTYPE" jdbcType="VARCHAR" property="wordtype" />
        <result column="PLURALITYTYPE" jdbcType="VARCHAR" property="pluralitytype" />
        <result column="CREDITLEVEL" jdbcType="VARCHAR" property="creditlevel" />
        <result column="CLIENTFLAG" jdbcType="VARCHAR" property="clientflag" />
        <result column="PHONENUMBER" jdbcType="VARCHAR" property="phonenumber" />
        <result column="FAX" jdbcType="VARCHAR" property="fax" />
        <result column="MOBILE" jdbcType="VARCHAR" property="mobile" />
        <result column="MOBILE1" jdbcType="VARCHAR" property="mobile1" />
        <result column="LINKADDRESS" jdbcType="VARCHAR" property="linkaddress" />
        <result column="PAGER" jdbcType="VARCHAR" property="pager" />
        <result column="EMAIL" jdbcType="VARCHAR" property="email" />
        <result column="EMAIL1" jdbcType="VARCHAR" property="email1" />
        <result column="RELATIONADDRESS1" jdbcType="VARCHAR" property="relationaddress1" />
        <result column="RELATIONADDRESS2" jdbcType="VARCHAR" property="relationaddress2" />
        <result column="RELATIONADDRESS3" jdbcType="VARCHAR" property="relationaddress3" />
        <result column="RELATIONADDRESS4" jdbcType="VARCHAR" property="relationaddress4" />
        <result column="HOMEPHONENUMBER" jdbcType="VARCHAR" property="homephonenumber" />
        <result column="HOMEPOSTCODE" jdbcType="VARCHAR" property="homepostcode" />
        <result column="HOMEADDRESS" jdbcType="VARCHAR" property="homeaddress" />
        <result column="WORKPHONENUMBER" jdbcType="VARCHAR" property="workphonenumber" />
        <result column="COMPANYNAME" jdbcType="VARCHAR" property="companyname" />
        <result column="SOCIALREGISTNUMBER" jdbcType="VARCHAR" property="socialregistnumber" />
        <result column="COMPANYKIND" jdbcType="VARCHAR" property="companykind" />
        <result column="WORKPOSTNUMBER" jdbcType="VARCHAR" property="workpostnumber" />
        <result column="WORKADDRESS1" jdbcType="VARCHAR" property="workaddress1" />
        <result column="WORKADDRESS2" jdbcType="VARCHAR" property="workaddress2" />
        <result column="WORKADDRESS3" jdbcType="VARCHAR" property="workaddress3" />
        <result column="WORKADDRESS4" jdbcType="VARCHAR" property="workaddress4" />
        <result column="OTHERADDRESS" jdbcType="VARCHAR" property="otheraddress" />
        <result column="OTHERPOSTCODE" jdbcType="VARCHAR" property="otherpostcode" />
        <result column="OTHERRELATION" jdbcType="VARCHAR" property="otherrelation" />
        <result column="NEWCLIENT" jdbcType="VARCHAR" property="newclient" />
        <result column="VALIDSTATUS" jdbcType="VARCHAR" property="validstatus" />
        <result column="ARTICLECODE" jdbcType="VARCHAR" property="articlecode" />
        <result column="NETADDRESS" jdbcType="VARCHAR" property="netaddress" />
        <result column="LOWERVIEWFLAG" jdbcType="VARCHAR" property="lowerviewflag" />
        <result column="FATHERCODE" jdbcType="VARCHAR" property="fathercode" />
        <result column="HANDLERCODE" jdbcType="VARCHAR" property="handlercode" />
        <result column="OPERATORCODE" jdbcType="VARCHAR" property="operatorcode" />
        <result column="INPUTDATE" jdbcType="TIMESTAMP" property="inputdate" />
        <result column="UPDATECODE" jdbcType="VARCHAR" property="updatecode" />
        <result column="UPDATEDATE" jdbcType="TIMESTAMP" property="updatedate" />
        <result column="COMCODE" jdbcType="VARCHAR" property="comcode" />
        <result column="DEATHDATE" jdbcType="TIMESTAMP" property="deathdate" />
        <result column="HEIGHT" jdbcType="DECIMAL" property="height" />
        <result column="WEIGHT" jdbcType="DECIMAL" property="weight" />
        <result column="ACCIDENTSTATUS" jdbcType="VARCHAR" property="accidentstatus" />
        <result column="HEALTH" jdbcType="VARCHAR" property="health" />
        <result column="SMOKEFLAG" jdbcType="VARCHAR" property="smokeflag" />
        <result column="CTEDITGRADE" jdbcType="VARCHAR" property="cteditgrade" />
        <result column="ICNO" jdbcType="VARCHAR" property="icno" />
        <result column="PROTERTY" jdbcType="VARCHAR" property="proterty" />
        <result column="WEALTH" jdbcType="VARCHAR" property="wealth" />
        <result column="INCOME" jdbcType="DECIMAL" property="income" />
        <result column="STATUS1" jdbcType="VARCHAR" property="status1" />
        <result column="MAKEDATE" jdbcType="TIMESTAMP" property="makedate" />
        <result column="MAKETIME" jdbcType="TIMESTAMP" property="maketime" />
        <result column="HOUSEHOLDER" jdbcType="VARCHAR" property="householder" />
        <result column="HONORTITLE" jdbcType="VARCHAR" property="honortitle" />
        <result column="SOCIALCODE" jdbcType="VARCHAR" property="socialcode" />
        <result column="LANGUAGE" jdbcType="VARCHAR" property="language" />
        <result column="DRIVINGLICENCEE" jdbcType="VARCHAR" property="drivinglicencee" />
        <result column="RETIRED" jdbcType="VARCHAR" property="retired" />
        <result column="SOCIALSECURITY" jdbcType="VARCHAR" property="socialsecurity" />
        <result column="BIRTHSECURITY" jdbcType="VARCHAR" property="birthsecurity" />
        <result column="MEDICARETYPE" jdbcType="VARCHAR" property="medicaretype" />
        <result column="MEDICARECITY" jdbcType="VARCHAR" property="medicarecity" />
        <result column="EMPLOYE" jdbcType="VARCHAR" property="employe" />
        <result column="EMPLOYEID" jdbcType="DECIMAL" property="employeid" />
        <result column="CLIENTGRADE" jdbcType="VARCHAR" property="clientgrade" />
        <result column="FOCUSTYPE" jdbcType="VARCHAR" property="focustype" />
        <result column="STATUS" jdbcType="VARCHAR" property="status" />
        <result column="ADDIND" jdbcType="VARCHAR" property="addind" />
        <result column="IDENTIFYSTARTDATE" jdbcType="TIMESTAMP" property="identifystartdate" />
        <result column="IDENTIFYENDDATE" jdbcType="TIMESTAMP" property="identifyenddate" />
        <result column="GENERALLANGUAGE" jdbcType="VARCHAR" property="generallanguage" />
        <result column="CHANNELCODE" jdbcType="VARCHAR" property="channelcode" />
        <result column="SURNAME" jdbcType="VARCHAR" property="surname" />
        <result column="MONIKER" jdbcType="VARCHAR" property="moniker" />
        <result column="FIRSTNAME" jdbcType="VARCHAR" property="firstname" />
        <result column="LASTNAME" jdbcType="VARCHAR" property="lastname" />
    </resultMap>
    <resultMap id="BaseResultMap1" type="cn.com.zsyk.crm.query.entity.GSClientpermain">
        <id column="CLIENTCODE" jdbcType="VARCHAR" property="clientcode" />
        <result column="REPORTORMOBILE" jdbcType="VARCHAR" property="reportormobile" />
    </resultMap>

    <select id="selectCustlist" parameterType="java.lang.String" resultMap="BaseResultMap" >
        SELECT gp.clientcode,gc.clientcname,gp.mobile,gp.sex,gp.birthdate,gp.nationality,gp.identifytype,
        gp.identifynumber,gp.idcardvalidity,gc.clienttype,gc.createtime,gc.updatetime,gp.country_code,
        gp.marriage,gp.Educationcode,gp.graduateSchool,gp.occupationCode,gp.companyName,gp.Homephonenumber,
        gp.itemProvinceCode,gp.itemCityCode,gp.addressCName,gp.postcode,gp.handlercode,gp.EMAIL
        FROM gsclientmain gc,gsclientpersona gp
        where gp.clientcode = gc.clientcode
        <if test="stampTime!=null and stampTime!=''">
            and gc.createtime &gt; TO_TIMESTAMP(#{stampTime,jdbcType=TIMESTAMP},'YYYY-MM-DD HH24:MI:SS:FF6')
        </if>

  </select>

    <!-- 获取所有客户的总数量 -->
    <select id="selectAllCustCount" parameterType="java.lang.String" resultType="java.lang.Long">
		select count(*)
		 FROM gsclientmain gc
            left join gsclientpersona gp
            on gp.clientcode = gc.clientcode
        <if test="stampTime!=null and stampTime!=''">
            where gc.createtime &gt; TO_TIMESTAMP(#{stampTime,jdbcType=TIMESTAMP},'YYYY-MM-DD HH24:MI:SS:FF6')
        </if>
	</select>
    <select id="selectReportormobileCount" parameterType="java.lang.String" resultType="java.lang.Long">
        select count(*)
        FROM(select  DISTINCT t_base.reportormobile,t_base2.clientcode
        FROM
		(SELECT  pr.reportormobile,pl.POLICYNO,pr.INPUTTIME
				FROM prplregist pr,prplregistsummary pl
				WHERE pr.registno = pl.registno AND pr.reportormobile IS NOT NULL)t_base
,
				(SELECT  gl.POLICYNO,gc.clientcode FROM gupolicymain gl,gsclientmain gc
				WHERE gc.clientcode = gl.applicode AND gc.clientcode IS NOT NULL)t_base2
          WHERE t_base.POLICYNO=t_base2.POLICYNO
        <if test="stampTime!=null and stampTime!=''">
            and t_base.INPUTTIME &gt; TO_TIMESTAMP(#{stampTime,jdbcType=TIMESTAMP},'YYYY-MM-DD HH24:MI:SS:FF6')
        </if>
        )
    </select>

    <select id="selectReportormobile" resultMap="BaseResultMap1">
        select DISTINCT t_base.reportormobile,t_base2.clientcode
        FROM
		(SELECT pr.reportormobile,pl.POLICYNO,pr.INPUTTIME
				FROM prplregist pr,prplregistsummary pl
				WHERE pr.registno = pl.registno AND pr.reportormobile IS NOT NULL)t_base,
				(SELECT gl.POLICYNO,gc.clientcode FROM gupolicymain gl,gsclientmain gc
				WHERE gc.clientcode = gl.applicode AND gc.clientcode IS NOT NULL)t_base2
          WHERE t_base.POLICYNO=t_base2.POLICYNO
        <if test="stampTime!=null and stampTime!=''">
            and t_base.INPUTTIME &gt; TO_TIMESTAMP(#{stampTime,jdbcType=TIMESTAMP},'YYYY-MM-DD HH24:MI:SS:FF6')
        </if>
    </select>

</mapper>