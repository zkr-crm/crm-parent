<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper
	namespace="cn.com.zsyk.crm.query.mapper.SysAutoRemindMapper">
	<resultMap id="BaseResultMap"
		type="cn.com.zsyk.crm.query.entity.SysAutoRemind">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<id column="MSG_ID" property="msgId" jdbcType="VARCHAR" />
		<result column="MSG_DESCRPTION" property="msgDescrption"
			jdbcType="VARCHAR" />
		<result column="MSG_EVENT_TYPE" property="msgEventType"
			jdbcType="VARCHAR" />
		<result column="CREATE_DATE" property="createDate"
			jdbcType="VARCHAR" />
		<result column="CREATE_TIME" property="createTime"
			jdbcType="VARCHAR" />
		<result column="CREATE_USER" property="createUser"
			jdbcType="VARCHAR" />
		<result column="UPDATE_DATE" property="updateDate"
			jdbcType="VARCHAR" />
		<result column="UPDATE_TIME" property="updateTime"
			jdbcType="VARCHAR" />
		<result column="UPDATE_USER" property="updateUser"
			jdbcType="VARCHAR" />
		<result column="REC_STAT" property="recStat" jdbcType="VARCHAR" />
		<result column="TIME_STAMP" property="timeStamp"
			jdbcType="VARCHAR" />
		<result column="MSG_ADVDAYS" property="msgAdvdays"
			jdbcType="VARCHAR" />
		<result column="MSG_TEMPLATE" property="msgTemplate" jdbcType="VARCHAR" />
	</resultMap>
	<resultMap id="EventBaseResultMap"
		type="cn.com.zsyk.crm.query.bo.CustEventBaseInfo">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<result column="MSG_EVENT_TYPE" jdbcType="VARCHAR"
			property="msgEventType" />
		<result column="CREATE_DATE" jdbcType="VARCHAR"
			property="createDate" />
		<result column="CREATE_USER" jdbcType="VARCHAR"
			property="createUser" />
		<result column="CUST_NO" jdbcType="VARCHAR" property="custNo" />
		<result column="CUST_AGENT" jdbcType="VARCHAR"
			property="custAgent" />
		<result column="CUST_NAM" jdbcType="VARCHAR"
			property="custName" />
	</resultMap>

	<resultMap id="RenwalBaseResultMap"
		type="cn.com.zsyk.crm.query.bo.RenwalEventBaseInfo">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		<result column="policyNo" jdbcType="VARCHAR"
			property="policyNo" />
		<result column="clientcname" jdbcType="VARCHAR"
			property="custName" />
		<result column="endDate" jdbcType="VARCHAR" property="endDate" />
		<result column="mobile" jdbcType="VARCHAR" property="mobile" />
	</resultMap>
	<delete id="deleteByPrimaryKey" parameterType="java.lang.String">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		delete from SYS_AUTO_REMIND
		where MSG_ID = #{msgId,jdbcType=VARCHAR}
	</delete>
	<insert id="insert"
		parameterType="cn.com.zsyk.crm.query.entity.SysAutoRemind">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		insert into SYS_AUTO_REMIND (MSG_ID, MSG_DESCRPTION, MSG_EVENT_TYPE,
		CREATE_DATE, CREATE_TIME, CREATE_USER,
		UPDATE_DATE, UPDATE_TIME,
		UPDATE_USER,
		REC_STAT, TIME_STAMP, MSG_ADVDAYS,
		MSG_TEMPLATE)
		values
		(#{msgId,jdbcType=VARCHAR}, #{msgDescrption,jdbcType=VARCHAR},
		#{msgEventType,jdbcType=VARCHAR},
		#{createDate,jdbcType=VARCHAR},
		#{createTime,jdbcType=VARCHAR}, #{createUser,jdbcType=VARCHAR},
		#{updateDate,jdbcType=VARCHAR}, #{updateTime,jdbcType=VARCHAR},
		#{updateUser,jdbcType=VARCHAR},
		#{recStat,jdbcType=VARCHAR},
		#{timeStamp,jdbcType=VARCHAR}, #{msgAdvdays,jdbcType=VARCHAR},
		#{msgTemplate,jdbcType=VARCHAR})
	</insert>
	<update id="updateByPrimaryKey"
		parameterType="cn.com.zsyk.crm.query.entity.SysAutoRemind">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		update SYS_AUTO_REMIND
		set MSG_DESCRPTION =
		#{msgDescrption,jdbcType=VARCHAR},
		MSG_EVENT_TYPE =
		#{msgEventType,jdbcType=VARCHAR},
		CREATE_DATE =
		#{createDate,jdbcType=VARCHAR},
		CREATE_TIME =
		#{createTime,jdbcType=VARCHAR},
		CREATE_USER =
		#{createUser,jdbcType=VARCHAR},
		UPDATE_DATE =
		#{updateDate,jdbcType=VARCHAR},
		UPDATE_TIME =
		#{updateTime,jdbcType=VARCHAR},
		UPDATE_USER =
		#{updateUser,jdbcType=VARCHAR},
		REC_STAT = #{recStat,jdbcType=VARCHAR},
		TIME_STAMP = #{timeStamp,jdbcType=VARCHAR},
		MSG_ADVDAYS =
		#{msgAdvdays,jdbcType=VARCHAR},
		MSG_TEMPLATE =
		#{msgTemplate,jdbcType=VARCHAR}
		where MSG_ID =
		#{msgId,jdbcType=VARCHAR}
	</update>
	<select id="selectByPrimaryKey" resultMap="BaseResultMap"
		parameterType="java.lang.String">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select MSG_ID, MSG_DESCRPTION, MSG_EVENT_TYPE, CREATE_DATE,
		CREATE_TIME, CREATE_USER,
		UPDATE_DATE, UPDATE_TIME, UPDATE_USER,
		REC_STAT, TIME_STAMP, MSG_ADVDAYS,
		MSG_TEMPLATE
		from SYS_AUTO_REMIND
		where MSG_ID = #{msgId,jdbcType=VARCHAR}
	</select>
	<select id="selectAll" resultMap="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. -->
		select MSG_ID, MSG_DESCRPTION, MSG_EVENT_TYPE, CREATE_DATE,
		CREATE_TIME, CREATE_USER,
		UPDATE_DATE, UPDATE_TIME, UPDATE_USER,
		REC_STAT, TIME_STAMP, MSG_ADVDAYS,
		MSG_TEMPLATE
		from SYS_AUTO_REMIND
	</select>
	<select id="selectAllRenwalByUser" parameterType="Map"
		resultType="cn.com.zsyk.crm.query.bo.RenwalEventBaseInfo">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. -->

		select distinct policy.policyno as policyNo,
		gr.enddate as endDate,
		gcm.clientcname as custName,
		gcm.clientcode as  clientCode,
		gp.mobile as mobile
		from
		gupolicyrelatedparty app,
		gupolicymain policy,
		gsclientmain gcm,
		gupolicyrisk gr,
		gsclientpersona gp
		where
		gcm.clientcode =
		policy.applicode
		and gcm.clientcode = gp.clientcode
		and policy.policyno
		= gr.policyno
		and app.policyno = policy.policyno
		and policy.SURRENDERIND
		!= 1
		and gr.enddate &gt;= sysdate
		and (gr.enddate - sysdate) &lt; 180
		and substr(gr.riskcode,1,2) in ('08','13')
		<if test="userId != 'dev'">
			<if test="custAgentList != null and custAgentList.size()>0">
				and policy.salesmancode in
				<foreach collection="custAgentList" index="index"
					item="item" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
		</if>
	</select>
</mapper>