<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.com.zsyk.crm.manage.mapper.SysMsgConfMapper" >
  <resultMap id="BaseResultMap" type="cn.com.zsyk.crm.manage.entity.SysMsgConf" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="MSG_ID" property="msgId" jdbcType="VARCHAR" />
    <result column="MSG_DESCRPTION" property="msgDescrption" jdbcType="VARCHAR" />
    <result column="MSG_EVENT_TYPE" property="msgEventType" jdbcType="VARCHAR" />
    <result column="CREATE_DATE" property="createDate" jdbcType="VARCHAR" />
    <result column="CREATE_TIME" property="createTime" jdbcType="VARCHAR" />
    <result column="CREATE_USER" property="createUser" jdbcType="VARCHAR" />
    <result column="UPDATE_DATE" property="updateDate" jdbcType="VARCHAR" />
    <result column="UPDATE_TIME" property="updateTime" jdbcType="VARCHAR" />
    <result column="UPDATE_USER" property="updateUser" jdbcType="VARCHAR" />
    <result column="REC_STAT" property="recStat" jdbcType="VARCHAR" />
    <result column="TIME_STAMP" property="timeStamp" jdbcType="VARCHAR" />
    <result column="MSG_ADVDAYS" property="msgAdvdays" jdbcType="VARCHAR" />
    <result column="MSG_TEMPLATE" property="msgTemplate" jdbcType="VARCHAR" />
    <result column="MSG_TITLE" property="msgTitle" jdbcType="VARCHAR" />
    <result column="MSG_TPL_CONT" property="msgTplCont" jdbcType="VARCHAR" />
  </resultMap>
  <resultMap id="MsgConfResultMap" type="cn.com.zsyk.crm.manage.bom.SysMsgConfInfo" extends="BaseResultMap">
    <result column="tpl_cont" property="tplCont"/>
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from SYS_MSG_CONF
    where MSG_ID = #{msgId,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="cn.com.zsyk.crm.manage.entity.SysMsgConf" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into SYS_MSG_CONF (MSG_ID, MSG_DESCRPTION, MSG_EVENT_TYPE, 
      CREATE_DATE, CREATE_TIME, CREATE_USER, 
      UPDATE_DATE, UPDATE_TIME, UPDATE_USER, 
      REC_STAT, TIME_STAMP, MSG_ADVDAYS, 
      MSG_TEMPLATE, MSG_TITLE, MSG_TPL_CONT)
    values (#{msgId,jdbcType=VARCHAR}, #{msgDescrption,jdbcType=VARCHAR}, #{msgEventType,jdbcType=VARCHAR}, 
      #{createDate,jdbcType=VARCHAR}, #{createTime,jdbcType=VARCHAR}, #{createUser,jdbcType=VARCHAR}, 
      #{updateDate,jdbcType=VARCHAR}, #{updateTime,jdbcType=VARCHAR}, #{updateUser,jdbcType=VARCHAR}, 
      #{recStat,jdbcType=VARCHAR}, #{timeStamp,jdbcType=VARCHAR}, #{msgAdvdays,jdbcType=VARCHAR}, 
      #{msgTemplate,jdbcType=VARCHAR} ,#{msgTitle,jdbcType=VARCHAR} ,#{msgTplCont,jdbcType=VARCHAR})
  </insert>
  <update id="updateByPrimaryKey" parameterType="cn.com.zsyk.crm.manage.entity.SysMsgConf" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update SYS_MSG_CONF
    set MSG_DESCRPTION = #{msgDescrption,jdbcType=VARCHAR},
      MSG_EVENT_TYPE = #{msgEventType,jdbcType=VARCHAR},
      CREATE_DATE = #{createDate,jdbcType=VARCHAR},
      CREATE_TIME = #{createTime,jdbcType=VARCHAR},
      CREATE_USER = #{createUser,jdbcType=VARCHAR},
      UPDATE_DATE = #{updateDate,jdbcType=VARCHAR},
      UPDATE_TIME = #{updateTime,jdbcType=VARCHAR},
      UPDATE_USER = #{updateUser,jdbcType=VARCHAR},
      REC_STAT = #{recStat,jdbcType=VARCHAR},
      TIME_STAMP = #{timeStamp,jdbcType=VARCHAR},
      MSG_ADVDAYS = #{msgAdvdays,jdbcType=VARCHAR},
      MSG_TEMPLATE = #{msgTemplate,jdbcType=VARCHAR},
      MSG_TITLE = #{msgTitle,jdbcType=VARCHAR},
      MSG_TPL_CONT = #{msgTplCont,jdbcType=VARCHAR}
    where MSG_ID = #{msgId,jdbcType=VARCHAR}
  </update>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select MSG_ID, MSG_DESCRPTION, MSG_EVENT_TYPE, CREATE_DATE, CREATE_TIME, CREATE_USER, 
    UPDATE_DATE, UPDATE_TIME, UPDATE_USER, REC_STAT, TIME_STAMP, MSG_ADVDAYS, MSG_TEMPLATE ,MSG_TITLE ,MSG_TPL_CONT
    from SYS_MSG_CONF
    where MSG_ID = #{msgId,jdbcType=VARCHAR}
  </select>
  <select id="selectAll" resultMap="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select MSG_ID, MSG_DESCRPTION, MSG_EVENT_TYPE, CREATE_DATE, CREATE_TIME, CREATE_USER, 
    UPDATE_DATE, UPDATE_TIME, UPDATE_USER, REC_STAT, TIME_STAMP, MSG_ADVDAYS, MSG_TEMPLATE ,MSG_TITLE ,MSG_TPL_CONT
    from SYS_MSG_CONF
  </select>
  <select id="getMsgConfByEntity" resultMap="BaseResultMap" parameterType="cn.com.zsyk.crm.manage.entity.SysMsgConf">

    SELECT t1.msg_id, t1.msg_descrption, t2.code_desc msg_event_type, t1.create_date, t1.create_time,
    t1.create_user, t1.update_date, t1.update_time, t1.update_user, t1.rec_stat,
    t1.time_stamp, t1.msg_advdays, t1.msg_template ,t1.msg_title ,t1.msg_tpl_cont
    FROM sys_msg_conf t1, sys_code_mng t2
    where t1.msg_event_type = t2.code_val
    and t2.type_desc='事件类型'
    <if test="msgId!= null and  msgId!= ''">
      and msg_id like CONCAT(CONCAT('%', #{msgId,jdbcType=VARCHAR}), '%')
    </if>
    <if test="msgEventType!= null and  msgEventType!= ''">
      and msg_event_type like CONCAT(CONCAT('%', #{msgEventType,jdbcType=VARCHAR}), '%')
    </if>
    <if test="msgDescrption!= null and  msgDescrption!= ''">
      and msg_descrption like CONCAT(CONCAT('%', #{msgDescrption,jdbcType=VARCHAR}), '%')
    </if>
    order by t1.time_stamp desc
  </select>
  <select id="getMsgConfSelfByEntity" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      短信自动发送
    -->
      SELECT t1.msg_id, t1.msg_descrption, t1.msg_event_type, t1.create_date, t1.create_time, t1.create_user,
             t1.update_date, t1.update_time, t1.update_user, t1.rec_stat, t1.time_stamp, t1.msg_advdays,
             t2.tpl_cont msg_template
      FROM
        sys_msg_conf t1,sys_msg_template t2
      where
        t1.msg_template = t2.tpl_no
        and t1.msg_id = #{msgId}
  </select>
  <select id="getMsgConfSelfByMsgId" resultMap="MsgConfResultMap" parameterType="java.lang.String" >
    <!--
      短息自动发送
    -->
    select r.MSG_ID, r.MSG_DESCRPTION, r.MSG_EVENT_TYPE, r.CREATE_DATE, r.CREATE_TIME, r.CREATE_USER,
    r.UPDATE_DATE, r.UPDATE_TIME, r.UPDATE_USER, r.REC_STAT, r.TIME_STAMP, r.MSG_ADVDAYS, r.MSG_TEMPLATE, r.MSG_TPL_CONT
    from sys_msg_conf r
    where r.MSG_ID = #{msgId,jdbcType=VARCHAR}
  </select>
</mapper>