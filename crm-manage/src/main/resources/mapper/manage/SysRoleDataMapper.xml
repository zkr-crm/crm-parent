<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.com.zsyk.crm.manage.mapper.SysRoleDataMapper">
  <resultMap id="BaseResultMap" type="cn.com.zsyk.crm.manage.entity.SysRoleData">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="role_code" jdbcType="VARCHAR" property="roleCode" />
    <id column="table_code" jdbcType="VARCHAR" property="tableCode" />
    <id column="field_code" jdbcType="VARCHAR" property="fieldCode" />
    <id column="match_condition" jdbcType="VARCHAR" property="matchCondition" />
    <result column="rule_code" jdbcType="VARCHAR" property="ruleCode" />
    <result column="is_contain_child" jdbcType="VARCHAR" property="isContainChild" />
    <result column="field_type" jdbcType="VARCHAR" property="fieldType" />
    <result column="rule_symbol" jdbcType="VARCHAR" property="ruleSymbol" />
    <result column="create_date" jdbcType="VARCHAR" property="createDate" />
    <result column="create_time" jdbcType="VARCHAR" property="createTime" />
    <result column="create_user" jdbcType="VARCHAR" property="createUser" />
    <result column="update_date" jdbcType="VARCHAR" property="updateDate" />
    <result column="update_time" jdbcType="VARCHAR" property="updateTime" />
    <result column="update_user" jdbcType="VARCHAR" property="updateUser" />
    <result column="time_stamp" jdbcType="TIMESTAMP" property="timeStamp" />
    <result column="rec_stat" jdbcType="VARCHAR" property="recStat" />
  </resultMap>
  
  <resultMap id="ResultMap" type="cn.com.zsyk.crm.manage.bom.SysDataAuthInfo">
    <id column="role_code" jdbcType="VARCHAR" property="roleCode" />
    <id column="table_code" jdbcType="VARCHAR" property="tableCode" />
    <id column="field_code" jdbcType="VARCHAR" property="fieldCode" />
    <id column="match_condition" jdbcType="VARCHAR" property="matchCondition" />
    <result column="rule_code" jdbcType="VARCHAR" property="ruleCode" />
    <result column="is_contain_child" jdbcType="VARCHAR" property="isContainChild" />
    <result column="field_type" jdbcType="VARCHAR" property="fieldType" />
    <result column="rule_symbol" jdbcType="VARCHAR" property="ruleSymbol" />
    <result column="create_date" jdbcType="VARCHAR" property="createDate" />
    <result column="create_time" jdbcType="VARCHAR" property="createTime" />
    <result column="create_user" jdbcType="VARCHAR" property="createUser" />
    <result column="update_date" jdbcType="VARCHAR" property="updateDate" />
    <result column="update_time" jdbcType="VARCHAR" property="updateTime" />
    <result column="update_user" jdbcType="VARCHAR" property="updateUser" />
    <result column="time_stamp" jdbcType="TIMESTAMP" property="timeStamp" />
    <result column="rec_stat" jdbcType="VARCHAR" property="recStat" />
  </resultMap>
  
    <resultMap id="DetailResultMap" type="cn.com.zsyk.crm.manage.bom.SysRoleDataDetail">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="role_code" jdbcType="VARCHAR" property="roleCode" />
    <id column="table_code" jdbcType="VARCHAR" property="tableCode" />
    <id column="field_code" jdbcType="VARCHAR" property="fieldCode" />
    <id column="match_condition" jdbcType="VARCHAR" property="matchCondition" />
    <result column="rule_code" jdbcType="VARCHAR" property="ruleCode" />
    <result column="is_contain_child" jdbcType="VARCHAR" property="isContainChild" />
    <result column="field_type" jdbcType="VARCHAR" property="fieldType" />
    <result column="rule_symbol" jdbcType="VARCHAR" property="ruleSymbol" />
    <result column="create_date" jdbcType="VARCHAR" property="createDate" />
    <result column="create_time" jdbcType="VARCHAR" property="createTime" />
    <result column="create_user" jdbcType="VARCHAR" property="createUser" />
    <result column="update_date" jdbcType="VARCHAR" property="updateDate" />
    <result column="update_time" jdbcType="VARCHAR" property="updateTime" />
    <result column="update_user" jdbcType="VARCHAR" property="updateUser" />
    <result column="time_stamp" jdbcType="TIMESTAMP" property="timeStamp" />
    <result column="rec_stat" jdbcType="VARCHAR" property="recStat" />
    <result column="table_name" jdbcType="VARCHAR" property="tableName" />
    <result column="field_name" jdbcType="VARCHAR" property="fieldName" />
    <result column="rule_name" jdbcType="VARCHAR" property="ruleName" />
  </resultMap>
  
  <delete id="deleteByPrimaryKey" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from sys_role_data
    where role_code = #{roleCode,jdbcType=VARCHAR}
      and table_code = #{tableCode,jdbcType=VARCHAR}
      and field_code = #{fieldCode,jdbcType=VARCHAR}
      and match_condition = #{matchCondition,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="cn.com.zsyk.crm.manage.entity.SysRoleData">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into sys_role_data (role_code, table_code, field_code, 
      match_condition, rule_code, is_contain_child, 
      create_date, create_time, create_user, 
      update_date, update_time, update_user, 
      time_stamp, rec_stat)
    values (#{roleCode,jdbcType=VARCHAR}, #{tableCode,jdbcType=VARCHAR}, #{fieldCode,jdbcType=VARCHAR}, 
      #{matchCondition,jdbcType=VARCHAR}, #{ruleCode,jdbcType=VARCHAR}, #{isContainChild,jdbcType=VARCHAR}, 
      #{createDate,jdbcType=VARCHAR}, #{createTime,jdbcType=VARCHAR}, #{createUser,jdbcType=VARCHAR}, 
      #{updateDate,jdbcType=VARCHAR}, #{updateTime,jdbcType=VARCHAR}, #{updateUser,jdbcType=VARCHAR}, 
      #{timeStamp,jdbcType=TIMESTAMP}, #{recStat,jdbcType=VARCHAR})
  </insert>
  <update id="updateByPrimaryKey" parameterType="cn.com.zsyk.crm.manage.entity.SysRoleData">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update sys_role_data
    set rule_code = #{ruleCode,jdbcType=VARCHAR},
      is_contain_child = #{isContainChild,jdbcType=VARCHAR},
      create_date = #{createDate,jdbcType=VARCHAR},
      create_time = #{createTime,jdbcType=VARCHAR},
      create_user = #{createUser,jdbcType=VARCHAR},
      update_date = #{updateDate,jdbcType=VARCHAR},
      update_time = #{updateTime,jdbcType=VARCHAR},
      update_user = #{updateUser,jdbcType=VARCHAR},
      time_stamp = #{timeStamp,jdbcType=TIMESTAMP},
      rec_stat = #{recStat,jdbcType=VARCHAR}
    where role_code = #{roleCode,jdbcType=VARCHAR}
      and table_code = #{tableCode,jdbcType=VARCHAR}
      and field_code = #{fieldCode,jdbcType=VARCHAR}
      and match_condition = #{matchCondition,jdbcType=VARCHAR}
  </update>
  <select id="selectByPrimaryKey" parameterType="map" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select role_code, table_code, field_code, match_condition, rule_code, is_contain_child, 
    create_date, create_time, create_user, update_date, update_time, update_user, time_stamp, 
    rec_stat
    from sys_role_data
    where role_code = #{roleCode,jdbcType=VARCHAR}
      and table_code = #{tableCode,jdbcType=VARCHAR}
      and field_code = #{fieldCode,jdbcType=VARCHAR}
      and match_condition = #{matchCondition,jdbcType=VARCHAR}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select role_code, table_code, field_code, match_condition, rule_code, is_contain_child,
    create_date, create_time, create_user, update_date, update_time, update_user, time_stamp,
    rec_stat
    from sys_role_data
  </select>

  <!-- 根据角色删除所有角色数据权限表记录 -->
  <delete id="deleteRoleDataByRole" parameterType="map">
    delete from sys_role_data
    where role_code = #{roleCode,jdbcType=VARCHAR}
  </delete>

  <!-- 根据角色表代码字段名删除角色数据权限记录 -->
  <delete id="deleteByRoleTableField" parameterType="map">
    delete from sys_role_data
    where
    role_code = #{roleCode,jdbcType=VARCHAR}
    and table_code = #{tableCode,jdbcType=VARCHAR}
    and field_code = #{fieldCode,jdbcType=VARCHAR}
  </delete>

  <!-- 根据角色和表名获取列表的数据权限信息 -->
  <select id="selectAuthByRoleAndTable" parameterType="map" resultMap="ResultMap">
    select t1.role_code, t1.table_code, t1.field_code, t1.match_condition, t1.rule_code, t1.is_contain_child,
    t2.field_type,t3.rule_symbol
    from sys_role_data t1,sys_data_option t2,sys_data_rule t3
    where 1=1
      and t1.table_code=t2.table_code
      and t1.field_code =t2.field_code
      and t1.rule_code = t3.rule_code
      and t1.role_code = #{roleCode,jdbcType=VARCHAR}
      and t1.table_code = #{tableCode,jdbcType=VARCHAR}
      and t1.rec_stat='0'
  </select>
  <select id="selectByFieldCode" parameterType="map" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select role_code, table_code, field_code, match_condition, rule_code, is_contain_child,
    create_date, create_time, create_user, update_date, update_time, update_user, time_stamp,
    rec_stat
    from sys_role_data
    where role_code = #{roleCode,jdbcType=VARCHAR}
    and table_code = #{tableCode,jdbcType=VARCHAR}
    and field_code = #{fieldCode,jdbcType=VARCHAR}
  </select>
  <select id="selectDetail" parameterType="map" resultMap="DetailResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select a.role_code, a.table_code, a.field_code, a.match_condition, a.rule_code, a.is_contain_child,
    a.create_date, a.create_time, a.create_user, a.update_date, a.update_time, a.update_user, a.time_stamp,
    a.rec_stat, b.table_name, b.field_name, c.rule_name
    from sys_role_data a, sys_data_option b, sys_data_rule c
    where a.role_code = #{roleCode,jdbcType=VARCHAR}
    and a.table_code = #{tableCode,jdbcType=VARCHAR}
    and a.table_code = b.table_code
    and a.field_code = b.field_code
    and a.rule_code = c.rule_code
  </select>
</mapper>